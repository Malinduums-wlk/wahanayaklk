{% extends 'base.html' %}
{% load static ads_extras %}

{% block title %}{{ shop.company_name }}{% endblock %}

{% block extra_css %}
<style>
    .shop-profile {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
    }

    @media (min-width: 1025px) {
        .shop-profile {
            width: 60vw;
        }
    }

    .cover-photo {
        width: 100%;
        height: 300px;
        position: relative;
        overflow: hidden;
        border-radius: 12px;
        margin-bottom: -60px;
    }

    .cover-photo img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .profile-section {
        padding: 2rem 1rem;
        margin: 0;
        position: relative;
    }

    .profile-header {
        display: flex;
        align-items: flex-end;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-left: 1rem;
    }

    .profile-picture {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 4px solid white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        margin-top: -60px;
    }

    .profile-picture img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .profile-info {
        flex: 1;
        padding: 0.5rem 0;
    }

    .company-name {
        font-size: 1.75rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        color: #333;
    }

    .owner-info {
        color: #666;
        margin-bottom: 1rem;
    }

    .contact-info {
        display: flex;
        align-items: center;
        gap: 2rem;
        margin-top: 1rem;
        flex-wrap: wrap;
    }

    .contact-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: #333;
        text-decoration: none;
    }

    .contact-item i {
        color: #3f51b5;
    }

    .contact-item:hover {
        color: #3f51b5;
    }

    /* Listings Section */
    .listings-section {
        padding: 2rem 1rem;
        background: transparent;
    }

    .listings-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .layout-toggle {
        display: flex;
        gap: 0.5rem;
    }

    .layout-toggle button {
        padding: 0.5rem;
        border: 1px solid #ddd;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .layout-toggle button.active {
        background: #3f51b5;
        color: white;
        border-color: #3f51b5;
    }

    .listings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .listings-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .default-shop-cover {
        background: linear-gradient(45deg, #3f51b5, #5c6bc0);
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 3rem;
    }

    .default-profile-pic {
        background: #5c6bc0;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2rem;
        border-radius: 50%;
    }
</style>
{% endblock %}

{% block content %}
<div class="shop-profile">
    <div class="cover-photo">
        {% if shop.cover_photo %}
        <img src="{{ shop.cover_photo.url }}" alt="{{ shop.company_name }} cover">
        {% else %}
        <div class="default-shop-cover">
            <i class="fas fa-store"></i>
        </div>
        {% endif %}
    </div>

    <div class="profile-section" style="background: transparent;">
        <div class="profile-header" style="background: transparent;">
            <div class="profile-picture">
                {% if shop.user.userprofile.profile_picture %}
                <img src="{{ shop.user.userprofile.profile_picture.url }}" alt="{{ shop.company_name }}">
                {% else %}
                <div class="default-profile-pic">
                    <i class="fas fa-user"></i>
                </div>
                {% endif %}
            </div>
            <div class="profile-info" style="background: transparent;">
                <h1 class="company-name">
                    {{ shop.company_name }}
                    {% if shop.user.userprofile.has_verified_badge %}
                    <i class="fas fa-check-circle text-primary" title="Verified"></i>
                    {% endif %}
                </h1>
                <div class="owner-info">Owned by {{ shop.user.get_full_name|default:shop.user.username }}</div>
                <div class="contact-info">
                    {% if shop.contact_number1 %}
                    <a href="tel:{{ shop.contact_number1 }}" class="contact-item">
                        <i class="fas fa-phone"></i>
                        {{ shop.contact_number1 }}
                    </a>
                    {% endif %}
                    {% if shop.whatsapp_number %}
                    <a href="https://wa.me/{{ shop.whatsapp_number }}" class="contact-item" target="_blank">
                        <i class="fab fa-whatsapp"></i>
                        {{ shop.whatsapp_number }}
                    </a>
                    {% endif %}
                    {% if shop.address %}
                    <span class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        {{ shop.address }}
                    </span>
                    {% endif %}
                    {% if shop.google_map_link %}
                    <a href="{{ shop.google_map_link }}" class="contact-item" target="_blank">
                        <i class="fas fa-map"></i>
                        See in Map
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="listings-section">
        <div class="listings-header">
            <h2>Listings</h2>
            <div class="layout-toggle">
                <button class="grid-view active" onclick="toggleLayout('grid')">
                    <i class="fas fa-th"></i>
                </button>
                <button class="list-view" onclick="toggleLayout('list')">
                    <i class="fas fa-list"></i>
                </button>
            </div>
        </div>

        <div class="vehicle-grid" id="listings-container">
            {% for vehicle in vehicles %}
                {% include "ads/includes/vehicle_card.html" with vehicle=vehicle %}
            {% empty %}
            <p class="text-muted">No listings available.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function toggleLayout(layout) {
    const container = document.getElementById('listings-container');
    const gridBtn = document.querySelector('.grid-view');
    const listBtn = document.querySelector('.list-view');

    if (layout === 'grid') {
        container.classList.remove('list-layout');
        gridBtn.classList.add('active');
        listBtn.classList.remove('active');
    } else {
        container.classList.add('list-layout');
        listBtn.classList.add('active');
        gridBtn.classList.remove('active');
    }
}
</script>
{% endblock %} 